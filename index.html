<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chase the Ace - Display</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Background Animation Container -->
    <div class="background-effects">
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
        <div class="confetti">♠</div>
    </div>

    <!-- Main Slideshow Container -->
    <div id="slideshow-container">
        
        <!-- Slide 1: Main Title & Logo -->
        <div class="slide active">
            <img src="logo.png" alt="Venue Logo" class="venue-logo" onerror="this.style.display='none'">
            <h1>CHASE THE ACE</h1>
            <img src="ace-of-spades.png" alt="Ace of Spades" class="ace-logo" onerror="this.style.display='none'">
            <h2>Join us for the Draw!</h2>
        </div>

        <!-- Slide 2: Current Jackpot -->
        <div class="slide">
            <h2>CURRENT JACKPOT</h2>
            <div class="jackpot-amount" id="display-jackpot">$0.00</div>
            <p>Jackpot increases by $100 after every draw!</p>
        </div>

        <!-- Slide 3: Tuesday Rules -->
        <div class="slide">
            <h2>TUESDAY DRAW</h2>
            <div class="time-box">
                <h3>Draw Time: 5:30 PM</h3>
            </div>
            <ul class="rules-list">
                <li>Purchase a beverage between <strong>3:00 PM - 5:30 PM</strong></li>
                <li>Receive a ticket for every drink purchased</li>
                <li>Be here for the draw to win!</li>
            </ul>
        </div>

        <!-- Slide 4: Saturday Rules -->
        <div class="slide">
            <h2>SATURDAY DRAW</h2>
            <div class="time-box">
                <h3>Draw Time: 6:30 PM</h3>
            </div>
            <ul class="rules-list">
                <li>Purchase a beverage between <strong>3:00 PM - 6:30 PM</strong></li>
                <li>Receive a ticket for every drink purchased</li>
                <li>Be here for the draw to win!</li>
            </ul>
        </div>

        <!-- Slide 5: How to Win -->
        <div class="slide">
            <h2>HOW TO WIN</h2>
            <p>If your ticket is pulled from the barrel:</p>
            <div class="step-box">
                <p>1. Pick a card from the cabinet (52 Cards)</p>
                <p>2. Flip the <strong>ACE OF SPADES</strong></p>
                <p>3. WIN THE JACKPOT!</p>
            </div>
        </div>

    </div>

    <script>
        // --- Configuration ---
        const slideDuration = 8000; // 8 seconds per slide

        // --- Slideshow Logic ---
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');

        function nextSlide() {
            // Remove active class from current
            slides[currentSlide].classList.remove('active');
            
            // Calculate next slide index
            currentSlide = (currentSlide + 1) % slides.length;
            
            // Add active class to next
            slides[currentSlide].classList.add('active');
        }

        // Start the rotation
        setInterval(nextSlide, slideDuration);

        // --- Jackpot Logic ---
        // TODO: Paste your Google Sheet CSV URL here inside the quotes
        // Example: "https://docs.google.com/spreadsheets/d/e/2PACX-.../pub?output=csv"
        const googleSheetUrl = "https://docs.google.com/spreadsheets/d/1OLWAKCEGzqDMrVnA8RfLfCEQoLlVeSDH8O0rt1Ltd4U/edit?usp=sharing"; 

        async function updateJackpotDisplay() {
            const displayEl = document.getElementById('display-jackpot');
            
            // Fallback to local storage if URL isn't set yet
            if (!googleSheetUrl) {
                const storedAmount = localStorage.getItem('cta_jackpot');
                if (storedAmount) displayEl.innerText = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'NZD' }).format(storedAmount);
                else if (displayEl.innerText === "$0.00") displayEl.innerText = "$500.00";
                return;
            }

            try {
                // Fetch data from Google Sheets (adding timestamp to prevent caching)
                const response = await fetch(googleSheetUrl + '&t=' + Date.now());
                const text = await response.text();
                
                // Clean the text to get just the number
                const amount = parseFloat(text.replace(/[^0-9.]/g, ''));
                
                if (!isNaN(amount)) {
                    displayEl.innerText = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);
                }
            } catch (e) { console.error("Error fetching jackpot:", e); }
        }

        // Check for jackpot updates every 5 seconds (in case admin updates it)
        updateJackpotDisplay();
        setInterval(updateJackpotDisplay, 60000);
    </script>
</body>
</html>
